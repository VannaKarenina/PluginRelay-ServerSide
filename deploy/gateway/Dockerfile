FROM node:lts-alpine

WORKDIR /app

COPY ./dist/apps/gateway .

COPY package-lock.json ./

ENV DB_HOST pg
ENV DB_PORT 5432
ENV DB_PASSWORD vOn4Ho4pJEGFcFB
ENV DB_USER postgres
ENV DB_DATABASE plugin_relay
ENV REDIS_HOST redis
ENV REDIS_PORT 6379
ENV JWT_SECRET JmLOD5DRO66HZDDlO3och5SdRHSh7cEXy9Dt9Pfk4uXGtSFFK5vemlVbLb9f
ENV JWT_TIMOUT 600
ENV AWS_KEYID M3D4N2MiralcWzHnD8vi
ENV AWS_KEY ceciBuunGhuod2MVnYiTzLfIsEr0sBPzwtwGYFHl
ENV AWS_ENDPOINT minio1:9000
ENV GATEWAY_PREFIX v1

RUN npm ci

EXPOSE 3890

CMD node ./main.js
